<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Hcprobe by ARCCN</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Hcprobe</h1>
        <p>Framework for testing OpenFlow controllers</p>

        <p class="view"><a href="https://github.com/ARCCN/hcprobe">View the Project on GitHub <small>ARCCN/hcprobe</small></a></p>


        <ul>
          <li><a href="https://github.com/ARCCN/hcprobe/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/ARCCN/hcprobe/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/ARCCN/hcprobe">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h2>
<a name="introduction" class="anchor" href="#introduction"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>Hcprobe is a framework for testing OpenFlow controllers. It includes
  a library in Haskell that provides means to work with OpenFlow
  protocol. Also it includes a reference implementation of an OpenFlow
  software switch and a domain-specific language (EDSL) for constructing
  new custom switches and writing programs for them.</p>
  
<p>
Hcprobe provides a bunch of libraries, which can be used for creating various tests (peformance, fuctional, security). The core of Hcprobe is FakeSwitch - a model of an OpenFlow switch with custom parameters and configuration. It performs initial handshake with a controller, defines a default switch behavior on receiving some types of OpenFlow messages and provides a callback-based interface for using it in your test scenarios.
</p>

<p>
You can implement any testcase you need using Haskell, though the most convinient way of creating new tests is with EDSL. EDSL provides means for creating any number of switches with custom settings, defining their logic, e.g. the scenario of sending any type of OpenFlow messages to the controller, and collecting various statistics.
</p>
  
<p>A typical EDSL test includes a definition of OpenFlow switches, a sending messages scenario and, optionally, setting han–ñdlers for incoming and outcoming messages, which collect statistics or redefine the default switch behavior. A simple example of EDSL test (running one switch, which sends one PacketIn with bad length):</p>

<pre><code>fakeSw <- config $ do
                switch $ do
                    addMACs [1..450]
                    features $ do
                      addPort [] [] [OFPPF_1GB_FD, OFPPF_COPPER] def
                      addPort [] [] [OFPPF_1GB_FD, OFPPF_COPPER] def
                      
withSwitch fakeSw "127.0.0.1" 6633 $ forever $ do
    let payload = putDefaultEthernetFrame
        msg     = putOFMessage $ do
                      putOFHeader $ do
                          putHdrType OFPT_PACKET_IN
                          putPacketLength 42 -- Bad length!
                      putPacketIn $ do
                          putPacketInData pl
        send msg
</code></pre>

<h2>
<a name="build" class="anchor" href="#build"><span class="octicon octicon-link"></span></a>Build</h2>

<p>To build hcprobe you need <a href="http://www.haskell.org/cabal/">cabal</a>.</p>

<p>To build it in a sandbox use cabal-dev tool:</p>

<pre><code>cabal insatall cabal-dev
</code></pre>

<p>Building hcprobe with cabal-dev:</p>

<pre><code>cd src
cabal update
cabal-dev install-deps
cabal-dev configure
cabal-dev build
</code></pre>

<p>Executables can be found in <em>dist/build/</em></p>

<h2>Hcprobe Tests</h2>

<p>Hcprobe contains a reference switch implementation test and a number
of EDSL test examples.</p>

<h3>Reference Switch</h3>
<p>For the source code see <strong>hcprobe.hs</strong>. This test emulates
several OpenFlow switches, sending fixed PacketIn messages (the idea is same to
the traditional <a href="http://docs.projectfloodlight.org/display/floodlightcontroller/Cbench">Cbench</a> controllers benchmark).</p>
<p>To run the reference switch implementation:</p>

<pre><code>./dist/build/hcprobe/hcprobe
</code></pre>

<p>By default it runs 16 OpenFlow switches, which try to connect
  to an OpenFlow controller at 127.0.0.1, port 6633.
   You can change IP and the TCP port, the number of emulated switches and switch ports, the number of unique MAC adresses (hosts), assosiated with one port, etc. For the list of options run with --help.</p>
   
<h3>EDSL Examples</h3>
<p>Source code for EDSL examples can be found in <em>examples</em>, executables - in <em>dist/build/</em>.</p>

<p>The following examples describe basic templates for defining OF switches and their logic:</p>
<ul>
<li><strong>userprogram.hs</strong> - a basic example of an EDSL program: crete a switch, send an automaicaly generated PacketIn message and a PacketIn message with custom fields.
<li><strong>simpleswitch.hs</strong> - creating OpenFlow switches with various settings.
<li><strong>packet_examples.hs</strong> - creating various OpenFlow messages with custom fields.
<li><strong>switch_concurrent.hs</strong> - running the same scenario on several switches.
<li><strong>switch_async.hs</strong> - running individual scenarios on different switches.
</ul>

<p>Also we used the following Hcprobe EDSL tests in our controllers testing project:</p>
<ul>
<li><strong>length.hs</strong> - sending PacketIn with an incorrect length field in the OF header.
<li><strong>version.hs</strong> - sending PacketIn with an invalid OF version.
<li><strong>type.hs</strong> - sending an OF message with OFPT_PACKET_IN in the OF header, but containing a  PortStatus message.
<li><strong>proto.hs</strong> - sending PacketIn with a malformed Ethernet frame (code of ARP protocol, but carrying IP).
<li><strong>ascii.hs</strong> - sending PortStatus with a malformed ASCII string in the port_name field.
<li><strong>trafficgen.hs</strong> - generating a sample workload profile.
</ul>

<p>For more information on writing tests with EDSL see Documentation.</p>
<p>When creating a new test note that you need to add it to the <strong>hcprobe.cabal</strong> file to build executables (see existing entries for an example), then rebuild Hcprobe (see <a href="#build">Build</a>).</p>

<h2>Contacts</h2>
<p>If you have any questions or wish to contribute, please contact us: <a href="mailto:dev@arccn.ru">dev@arccn.ru</a>.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/ARCCN">ARCCN</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
<!--Google Analytics-->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-42051989-1']);
  _gaq.push(['_setDomainName', 'arccn.github.io']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</html>
